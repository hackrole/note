language: python
branches:
  only:
    - master
install:
  - pip install pipenv
  - pipenv install --dev --deploy
script:
  - echo ${GITHUB_TOKEN}
  - fab build

deploy:
  provider: pages
  skip-cleanup: true
  repo: hackrole/hackrole.github.io
  target-branch: master
  local-dir: output
  github-token: $GITHUB_TOKEN
  keep-history: false
  # fqdn: pages.hackrole.com

notifications:
  email: false
  slack:
    rooms:
      - ${SLACK_TOKEN}
    on_success: always
    on_failure: always
    template:
      - "Repo `%{repository_slug}` *%{result}* build (<%{build_url}|#%{build_number}>) for commit (<%{compare_url}|%{commit}>) on branch `%{branch}`."
      - "Execution time: *%{duration}*"
      - "Message: %{message}"
